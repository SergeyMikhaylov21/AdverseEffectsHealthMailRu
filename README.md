# AdverseEffectsHealthMailRu

Репозиторий созданной в рамках платформы GATE модели машинного обучения для извлечения предложений с описанием побочных эффектов препаратов из русскоязычных медицинских социальных сетей (в частности, [Здоровье@mail.ru](https://health.mail.ru/consultation/)).
Данный репозиторий содержит инструкцию по использованию модели машинного обучения, а также необходимые для этого файлы.

<p>Официальный сайт платформы GATE: https://gate.ac.uk/</p>
<p>Подробная информация о машинном обучении в GATE: https://gate.ac.uk/sale/tao/splitch19.html</p>
<p>Презентация с подробным разбором примеров реализации машинного обучения в GATE - файл <i>ML GATE.pdf</i></p>

Ссылка на тренировочный и тестовый корпуса: https://yadi.sk/d/54nWF-UN3Wfqg4.
Краулер для скачивания текстов - файл <i>Health.Mail.ru - Crawler.ipynb</i>. Тексты корпусов размечены по предложениям: для каждого предложения был создан атрибут adv, который может принимать два значения: adv=yes для предложения, в котором содержится описание побочного эффекта препарата, и adv=no для всех остальных предложений. Таким образом, машинное обучение сводилось к задаче <b>бинарной классификации</b>.
Из корпуса случайным образом были взяты 240 текстов для обучения, оставшиеся 60 использовались для тестирования работы модели.

Для удобства рекомендуется создать на компьютере отдельную директорию (например, Model_Files), в которой будут находиться папки для тренировочного и тестового корпусов, xml-файл с признаками для машинного обучения (classification-features) и файлы модели (info.yaml, lf.model, pipe.pipe).
<p>Модель машинного обучения: алгоритм SVM из библиотеки LibSVM(https://www.csie.ntu.edu.tw/~cjlin/libsvm/), адаптированный для GATE. Показатели эффективности работы модели: точность - <b>0.69</b>, полнота - <b>0.39</b>, F-мера - <b>0.48</b>, коэффициент каппы Коэна - <b>0.4496</b>.</p>

<h3>Использование модели</h3>

Цепочка ресурсов GATE:
<ol>
	<li>Document Reset</li>
	<li>Токенизатор (использован стандартный ANNIE English Tokenizer)</li>
	<li>Сплиттер (например, RegEx Sentence Splitter)</li>
	<li>Морфологизатор (можно воспользоваться инструментами из GATE плагина для русского языка (https://gate.ac.uk/gate/doc/plugins.html#Lang_Russian). Основная задача этого инструмента - сформировать для каждого слова аннотацию Morph, где в атрибуте baseForm будет записана начальная форма слова)</li>
	<li>hash-газеттир (можно взять hash-газеттир из плагина по ссылке в предыдущем пункте - на вход этому инструменту подаются начальные формы слов из морфологизатора. Загружаемые в газеттир словари находятся в папке Lookup)</li>
	<li>JAPE-трансдьюсер (базовый инструмент GATE, все файлы для его запуска находятся в папке Transducer - предназначен для генерирования аннотаций-признаков для машинного обучения)</li>
	<li>Apply Classification - инструмент для запуска классификации (один из ресурсов загружаемого плагина GATE Learning Framework (https://gatenlp.github.io/gateplugin-LearningFramework/)).</li>
</ol>

![alt text](https://github.com/SergeyMikhaylov21/AdverseEffectsHealthMailRu/blob/master/pipeline.png)

<h4>Настройка параметров Apply Classification</h4>
<ul>
	<li>algorithmParameters: -t 0 -c 5 -w0 1 -w1 2.5</li>
	<li>confidenceThreshold: 0.0</li>
	<li>dataDirectory: ссылка на директорию Model_Files. В эту директорию необходимо поместить две папки, training_corpus и test_corpus, содержащие, соответственно, тренировочный и тестовый корпуса.</li>
	<li>instanceType: Sentence</li>
	<li>outputASName: LearningFramework</li>
	<li>targetFeature: adv</li>
</ul>